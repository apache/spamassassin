# These are oddities seen in Other People's Spam, i.e. I have no hits in my test corpora 

describe	__HAS_IMG_SRC	Has an img tag on a non-quoted line
rawbody		__HAS_IMG_SRC	/^[^>].*?<img src=/im
tflags		__HAS_IMG_SRC	multiple maxhits=100

describe	__HAS_HREF	Has an anchor tag with a href attribute in non-quoted line
rawbody		__HAS_HREF	/^[^>].*?<a href=/im
tflags		__HAS_HREF	multiple maxhits=100

describe	__HAS_IMG_SRC_ONECASE	Has an img tag on a non-quoted line with consistent case
rawbody		__HAS_IMG_SRC_ONECASE	/^[^>].*?<(img src|IMG SRC)=/m
tflags		__HAS_IMG_SRC_ONECASE	multiple maxhits=100

describe	__HAS_HREF_ONECASE	Has an anchor tag with a href attribute in non-quoted line with consistent case
rawbody		__HAS_HREF_ONECASE	/^[^>].*?<(a href|A HREF)=/m
tflags		__HAS_HREF_ONECASE	multiple maxhits=100

describe	__MIXED_IMG_CASE	Has img tags with mixed-up cases in non-quoted lines
meta		__MIXED_IMG_CASE	__HAS_IMG_SRC - __HAS_IMG_SRC_ONECASE > 0

describe	__MIXED_HREF_CASE	Has anchor tags with mixed-up cases in non-quoted lines
meta		__MIXED_HREF_CASE	__HAS_HREF - __HAS_HREF_ONECASE > 0

describe	__MIXED_TAG_CASE	Has multiple mixed-case tags in non-quoted lines.
meta		__MIXED_TAG_CASE	__MIXED_IMG_CASE && __MIXED_HREF_CASE

describe	SCC_THREE_WORD_MONTY	Are you POTUS or a mass murderer? 
header		SCC_THREE_WORD_MONTY	From =~ /(\w{2,}) (\w{2,}) (\w{2,}) <\1.\2.\3/

# Fingerprint Majordomo lists
header __SCC_MD_UNSUB List-Unsubscribe =~ /: <mailto:majordomo\@/
tflags __SCC_MD_UNSUB nice
header __SCC_MD_SUB List-Subscribe =~ /: <mailto:majordomo\@/
tflags __SCC_MD_SUB nice
header __SCC_MD_SENDER Sender =~ /\bowner-/
tflags __SCC_MD_SENDER nice
header __SCC_MD_RCVD_OUT Received =~ /-outgoing@/
tflags __SCC_MD_RCVD_OUT nice
describe SCC_MAJORDOMO Multiple indications of the majordomo list manager
meta SCC_MAJORDOMO __SCC_MD_UNSUB + __SCC_MD_SUB + __SCC_MD_SENDER + __SCC_MD_RCVD_OUT > 1
tflags SCC_MAJORDOMO nice

describe  SCC_ODD_MUA  Unlikely MUA for a modern human
header    SCC_ODD_MUA  X-Mailer =~ /^X-Mailer: Microsoft Outlook 14.0$/


describe  SCC_SPECIAL_GUID      Unique in a similar way
rawbody   SCC_SPECIAL_GUID	/^([[:xdigit:]]{8})-([[:xdigit:]]{4})-([[:xdigit:]]{3})-\3-([[:xdigit:]]{12})$/m
tflags    SCC_SPECIAL_GUID	publish multiple maxhits=15

describe __NO_EXTERNALS	No external relays
header   __NO_EXTERNALS	X-Spam-Relays-External =~ /^$/

describe ALL_INTERNAL	Has only internal relays
meta     ALL_INTERNAL	__NO_EXTERNALS && !NO_RELAYS
tflags   ALL_INTERNAL	nice

describe SCC_NEWBIE_HASBEENS	Abused gTLDs seen in spam from Google Apps.  
header   SCC_NEWBIE_HASBEENS	X-Beenthere =~ /\.(today|online|monster)/

describe  T_SCC_HTML_OBJOBJ	Contains an object
rawbody   T_SCC_HTML_OBJOBJ	/< *object +\w{65,80} *>/

describe SCC_ISEMM_LID_1	Fingerprint of a particular spammer using an old spamware
header SCC_ISEMM_LID_1		X-Mailer-LID =~ /54,55,56,58,53/
tflags SCC_ISEMM_LID_1		publish
score SCC_ISEMM_LID_1		3.5

describe SCC_SPAMMER_ADDR_1	Fingerprint of a particular spammer
body     SCC_SPAMMER_ADDR_1	/34 N Franklin/

describe SCC_SPAMMER_ADDR_2	Fingerprint of a particular spammer
body     SCC_SPAMMER_ADDR_2	/6130 W Flamingo Rd/

describe SCC_CANSPAM_1		Interesting compliance language
body	 SCC_CANSPAM_1		/The advertiser does not manage your subscription/

describe SCC_CANSPAM_2		Interesting compliance language
body	 SCC_CANSPAM_2		/you may unsubscribe by clicking here or by writing to/

# 1-3 are antique and stale. This sha256.sha256@*.co pattern is fresh in 2022
describe SCC_SPAMMERMID4        Distinctive Message-Id
header   SCC_SPAMMERMID4        Message-ID =~ /<[-_a-zA-Z0-9.]{43}\.[-_a-zA-Z0-9.]{43}\@[-a-z0-9]{4,30}\.co>/
score    SCC_SPAMMERMID4        1

describe T_SCC_ESP_RESY		From "Resy" which is known to emit spam
body	T_SCC_ESP_RESY		/This marketing message was sent to you by Resy/


# TESTING a few domains that are in our "suspicious" list but are known to have some good senders
describe T_SCC_TLD_ONLINE From domain in *.online 
header   T_SCC_TLD_ONLINE From =~ /<[^ @]+@[^ @>]+\.online>/

describe T_SCC_TLD_XYZ From domain in *.xyz
header   T_SCC_TLD_XYZ From =~ /<[^ @]+@[^ @>]+\.xyz>/

describe	T_SCC_URL_NOTIONSITE  has a notion.site URL
uri		T_SCC_URL_NOTIONSITE  /https?:\/\/[^ ]*\.notion.site/
tflags		T_SCC_URL_NOTIONSITE  multiple maxhits=5


describe	T_SCC_URL_CLOUDINARY  Has Cloudinary backend(?) URL
uri		T_SCC_URL_CLOUDINARY  /https?:\/\/res.cloudinary.com/
tflags		T_SCC_URL_CLOUDINARY  multiple maxhits=5
