# SpamAssassin rules file: meta tests.
# $Id: 20_meta_tests.cf,v 1.7 2002/09/04 18:52:50 jmason Exp $
#
# Add meta tests which cover *both* headers and body here.
# 
# note: body tests are run with long lines, so be sure to limit the
# size of searches; use ".{0,30}" instead of ".*" to avoid huge
# search times.
###########################################################################

require_version 2.50

# some tests that will trigger FPs on ISO-2022-JP mails.

body __ISO_2022_JP_DELIM	/\e\$B/

body __THREE_DOLLARS		/\${3,}/
header __MANY_EXCLS             Subject =~ /![^!]+!/
header __PLING_PLING            Subject =~ /!!!/

body __UPPERCASE_25_50          eval:check_for_uppercase('25', '50')
body __UPPERCASE_50_75          eval:check_for_uppercase('50', '75')
body __UPPERCASE_75_100         eval:check_for_uppercase('75', '100')

meta CASHCASHCASH		(!__ISO_2022_JP_DELIM && __THREE_DOLLARS)
describe CASHCASHCASH		Contains at least 3 dollar signs in a row
meta MANY_EXCLAMATIONS          (!__ISO_2022_JP_DELIM && __MANY_EXCLS)
describe MANY_EXCLAMATIONS      Subject has many exclamations
meta UPPERCASE_25_50            (!__ISO_2022_JP_DELIM && __UPPERCASE_25_50)
describe UPPERCASE_25_50        message body is 25-50% uppercase
meta UPPERCASE_50_75            (!__ISO_2022_JP_DELIM && __UPPERCASE_50_75)
describe UPPERCASE_50_75        message body is 50-75% uppercase
meta UPPERCASE_75_100           (!__ISO_2022_JP_DELIM && __UPPERCASE_75_100)
describe UPPERCASE_75_100       message body is 75-100% uppercase
meta PLING_PLING                (!__ISO_2022_JP_DELIM && __PLING_PLING)
describe PLING_PLING            Subject has lots of exclamation marks


